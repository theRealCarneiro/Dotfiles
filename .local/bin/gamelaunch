#!/bin/sh

game_dir="$XDG_DATA_HOME/applications/Games"

game_list=$(
	sed -n 's/^Icon=/\\0icon\\0037/p; s/^Name=//p; ' $game_dir/* | sed -e 'N;s/\n//'
)

game=$(printf "%b" "$game_list" | rofi -dmenu -p "ï„›" -i) || exit

exec=$(sed -n 's/^Exec=//p' "$game_dir/$game.desktop")

eval $(grep Comment "$game_dir/$game.desktop")

user=games

grep -w nogameuser "$game_dir/$game.desktop" 2>/dev/null && user=$USER

#PULSE_SERVER=tcp:127.0.0.1:4713
#export PULSE_SERVER

gamemoderun sudo -u $user PULSE_SERVER=tcp:127.0.0.1:4713 $exec
