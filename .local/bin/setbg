#!/bin/sh

reload_env(){
	xrdb $XDG_CONFIG_HOME/X11/.Xresources # Source Xresources
	if [ $WM = "dwm" ]; then
		dwm-msg run_command reload_xresources & # make dwm reload xrdb
	fi
	polyLaunch & # restart polybar
	spicetify apply -n & # apply spotify theme
}

#rand(){
	#wpp=$(find $HOME/Bibliotecas/Imagens/Wallpapers -type f | shuf | head -n1)
#}

#theme(){
	#wpp=$(grep wallpaper $HOME/.config/wal/colorschemes/dark/$1.json | cut -c16- | sed 's/..$//')
	#wal --theme $1 &
	#reload_env &
#}

#generate(){
	#wpp=$1
	#wal -i "$wpp"
	#reload_env &
#}

#if [ $# -ne 0 ]; then #if there are args
	#case $1 in
		#"--rand")		
			#rand ;;
		#"--theme")
			#theme $2 ;;
		#"--generate")
			#generate $2 ;;
		#*)
			#wpp=$1 ;;
	#esac

	#if [ "${wpp##*$PWD*}" -a $1 != "--theme" ]; then #full path of image
		#echo $PWD/$wpp > $wall
	#else
		#echo $wpp > $wall
	#fi
#fi

#pcmanfm -w "$(cat $wall)"

wall="$XDG_CONFIG_HOME/wallpaper"
if [ $# -ne 0 ]; then #if there are args

	if [ $1 = "--rand" ]; then
		wpp=$(find $HOME/Bibliotecas/Imagens/Wallpapers -type f | shuf | head -n1)


	elif [ $1 = "--theme" ]; then
		wpp=$(grep wallpaper $HOME/.config/wal/colorschemes/dark/$2.json | cut -c16- | sed 's/..$//')

		wal --theme $2
		reload_env &


	elif [ $1 = "--generate" ]; then
		wpp=$2
		wal -i "$wpp"
		reload_env &

	else
		wpp=$1
	fi

	if [ "${wpp##*$PWD*}" -a "$1" != "--theme" ]; then #full path of image
		echo $PWD/$wpp > $wall
	else
		echo $wpp > $wall
	fi
fi
xwallpaper --zoom "$(cat $wall)" 


